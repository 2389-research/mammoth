{{define "content"}}
<style>
    .new-shell {
        display: grid;
        gap: 14px;
        max-width: 860px;
    }
    .new-hero {
        border-radius: var(--radius-2xl);
        border: 1px solid color-mix(in srgb, var(--border) 86%, #0891b2 14%);
        background:
            radial-gradient(circle at 84% 12%, color-mix(in srgb, #22d3ee 16%, transparent), transparent 36%),
            linear-gradient(160deg, color-mix(in srgb, var(--bg-card) 88%, #f0fdfa 12%), var(--bg-card));
        padding: 18px 20px;
    }
    .new-hero h1 {
        margin: 0;
        font-family: var(--font-display);
    }
    .new-hero p {
        margin: 8px 0 0 0;
        color: var(--text-secondary);
        font-size: 13px;
        max-width: 68ch;
    }
    .new-form-card {
        border-radius: var(--radius-2xl);
        border: 1px solid var(--border);
        background: var(--bg-card);
        box-shadow: 0 16px 44px color-mix(in srgb, #0f172a 9%, transparent);
        padding: 16px;
        display: grid;
        gap: 12px;
    }
    .new-file-note {
        margin: 6px 0 0 0;
        color: var(--text-muted);
        font-size: 12px;
    }
    .new-params {
        margin-top: 6px;
        display: grid;
        gap: 8px;
    }
    .new-param {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 13px;
        color: var(--text-primary);
    }
    .new-param input {
        margin-top: 2px;
    }
    .new-param-note {
        margin: 2px 0 0 22px;
        color: var(--text-muted);
        font-size: 12px;
    }
    .new-submit-state {
        display: none;
        margin-top: 8px;
        color: var(--text-secondary);
        font-size: 13px;
    }
    .new-submit-state.active {
        display: block;
    }
    .new-submit-state .dots::after {
        content: "";
        animation: newSubmitDots 1.1s steps(3, end) infinite;
    }
    @keyframes newSubmitDots {
        0% { content: ""; }
        33% { content: "."; }
        66% { content: ".."; }
        100% { content: "..."; }
    }
</style>

<section class="new-shell">
    <section class="new-hero">
        <h1>New Project</h1>
        <p>Start from a prompt, or import an existing specification/DOT file. Weâ€™ll initialize the full workflow automatically.</p>
    </section>

    <section class="new-form-card">
        <form id="new-project-form" method="POST" action="/projects" enctype="multipart/form-data">
            <div class="form-group">
                <label for="prompt">Spec Prompt</label>
                <textarea id="prompt" name="prompt" rows="8" placeholder="Describe the product or workflow you want to build..."></textarea>
            </div>

            <div class="form-group">
                <label>Spec Builder Parameters</label>
                <div class="new-params">
                    <label class="new-param"><input type="checkbox" name="opt_human_review" value="1" checked>Human review gates</label>
                    <p class="new-param-note">Add explicit approval checkpoints.</p>

                    <label class="new-param"><input type="checkbox" name="opt_scenario_testing" value="1" checked>Scenario testing</label>
                    <p class="new-param-note">Require end-to-end scenario validation.</p>

                    <label class="new-param"><input type="checkbox" name="opt_tdd" value="1">Test-driven development</label>
                    <p class="new-param-note">Favor tests before implementation.</p>
                </div>
            </div>

            <div class="form-group">
                <label for="import_file">Or Upload File</label>
                <input type="file" id="import_file" name="import_file" accept=".dot,.gv,.txt,.md,.markdown,.yaml,.yml,.json,.spec">
                <p class="new-file-note">Supported formats: DOT, Markdown, YAML, JSON, and plain spec text.</p>
            </div>

            <div class="web-inline-actions">
                <button id="create-project-btn" type="submit" class="btn btn-primary">Create Project</button>
                <a href="/" class="btn">Cancel</a>
            </div>
            <p id="create-project-state" class="new-submit-state" aria-live="polite">
                Creating project<span class="dots"></span> This can take up to a minute while parsing/import runs.
            </p>
        </form>
    </section>
</section>
<script>
(function() {
    var form = document.getElementById('new-project-form');
    var btn = document.getElementById('create-project-btn');
    var state = document.getElementById('create-project-state');
    if (!form || !btn || !state) {
        return;
    }
    var isSubmitting = false;
    form.addEventListener('submit', function(e) {
        if (isSubmitting) {
            e.preventDefault();
            return;
        }
        isSubmitting = true;
        btn.disabled = true;
        btn.textContent = 'Creating project...';
        state.classList.add('active');
    });
})();
</script>
{{end}}
