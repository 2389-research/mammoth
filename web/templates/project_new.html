{{define "content"}}
<link rel="stylesheet" href="/static/css/project-new.css">

<section class="new-shell">
    <section class="new-hero">
        <h1>New Project</h1>
        <p>Start from a prompt, or import an existing specification/DOT file. Weâ€™ll initialize the full workflow automatically.</p>
    </section>

    <section class="new-form-card">
        <form id="new-project-form" method="POST" action="/projects" enctype="multipart/form-data">
            <div class="form-group">
                <label for="prompt">Spec Prompt</label>
                <textarea id="prompt" name="prompt" rows="8" placeholder="Describe the product or workflow you want to build..."></textarea>
            </div>

            <div class="form-group">
                <label>Spec Builder Parameters</label>
                <div class="new-params">
                    <label class="new-param"><input type="checkbox" name="opt_human_review" value="1" checked>Human review gates</label>
                    <p class="new-param-note">Add explicit approval checkpoints.</p>

                    <label class="new-param"><input type="checkbox" name="opt_scenario_testing" value="1" checked>Scenario testing</label>
                    <p class="new-param-note">Require end-to-end scenario validation.</p>

                    <label class="new-param"><input type="checkbox" name="opt_tdd" value="1">Test-driven development</label>
                    <p class="new-param-note">Favor tests before implementation.</p>
                </div>
            </div>

            <div class="form-group">
                <label for="import_file">Or Upload File</label>
                <input type="file" id="import_file" name="import_file" accept=".dot,.gv,.txt,.md,.markdown,.yaml,.yml,.json,.spec">
                <p class="new-file-note">Supported formats: DOT, Markdown, YAML, JSON, and plain spec text.</p>
            </div>

            <div class="web-inline-actions">
                <button id="create-project-btn" type="submit" class="btn btn-primary">Create Project</button>
                <a href="/" class="btn">Cancel</a>
            </div>
            <p id="create-project-state" class="new-submit-state" aria-live="polite">
                Creating project<span class="dots"></span> This can take up to a minute while parsing/import runs.
            </p>
        </form>
    </section>
</section>
<script>
(function() {
    var form = document.getElementById('new-project-form');
    var btn = document.getElementById('create-project-btn');
    var state = document.getElementById('create-project-state');
    if (!form || !btn || !state) {
        return;
    }
    var isSubmitting = false;
    form.addEventListener('submit', function(e) {
        if (isSubmitting) {
            e.preventDefault();
            return;
        }
        isSubmitting = true;
        btn.disabled = true;
        btn.textContent = 'Creating project...';
        state.classList.add('active');
    });
})();
</script>
{{end}}
